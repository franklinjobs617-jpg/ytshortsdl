<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free YouTube Shorts Downloader | HD, MP4, MP3 & Batch Tools</title>
    <meta name="description"
        content="Download YouTube Shorts videos and audio (MP4/MP3) instantly and for free. The fastest YT Shorts Downloader with no ads, including free batch download mode. Unlock PRO AI tools for creators.">
    <!-- Core Tech Stack -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <meta name="theme-color" content="#EF4444">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ytshortsdl.net/">
    <meta property="og:image" content="https://ytshortsdl.net/images/1.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free YouTube Shorts Downloader | HD, MP4, MP3 & AI Tools">
    <meta name="twitter:description" content="Download YouTube Shorts (MP4/MP3) instantly. No ads. With AI tools.">
    <meta name="twitter:image" content="https://ytshortsdl.net/images/1.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="canonical" href="https://ytshortsdl.net/">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* Custom scrollbar for new batch UI elements */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d1d5db;
            /* gray-300 */
            border-radius: 10px;
        }

        /* Custom Ring for focus states */
        .custom-focus-ring:focus-within {
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.3);
        }

        .glow-effect {
            position: absolute;
            top: -50%;
            left: 50%;
            transform: translateX(-50%);
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(239, 68, 68, 0.1) 0%, rgba(255, 255, 255, 0) 70%);
            pointer-events: none;
            z-index: 0;
        }

        /* Markdown Styles for Summary Output */
        #summary-text-output ul {
            list-style-type: disc;
            padding-left: 1.5em;
            margin-bottom: 0.5em;
        }

        #summary-text-output ol {
            list-style-type: decimal;
            padding-left: 1.5em;
            margin-bottom: 0.5em;
        }

        #summary-text-output li {
            margin-bottom: 0.25em;
        }

        #summary-text-output strong {
            font-weight: 700;
            color: #1e293b;
        }

        #summary-text-output h1 {
            font-size: 1.5em;
            font-weight: 700;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
        }

        #summary-text-output h2 {
            font-size: 1.25em;
            font-weight: 700;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
        }

        #summary-text-output h3 {
            font-size: 1.1em;
            font-weight: 600;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
        }

        #summary-text-output p {
            margin-bottom: 0.75em;
        }

        #summary-text-output blockquote {
            border-left: 4px solid #e2e8f0;
            padding-left: 1em;
            color: #64748b;
            font-style: italic;
        }
    </style>
    <script type="text/javascript">
        (function (c, l, a, r, i, t, y) {
            c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
            t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
            y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
        })(window, document, "clarity", "script", "u5xi8vjmmq");
    </script>

    <meta name="google-adsense-account" content="ca-pub-3383070348689557">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3383070348689557"
        crossorigin="anonymous"></script>
</head>

<body class="antialiased font-sans text-slate-800">

    <!-- Header - REBUILT ACCORDING TO NAVIGATION DESIGN -->
    <header class="py-4 px-6 md:px-12 sticky top-0 bg-white/80 backdrop-blur-xl z-50 border-b border-slate-200/80">
        <nav class="flex justify-between items-center max-w-7xl mx-auto">
            <a href="/" class="text-2xl font-bold font-poppins flex-shrink-0 flex items-center gap-2">
                <img src="/favicon.ico" alt="" class="w-12 h-12">
                <span>
                    YTShorts<span class="text-red-500">dl</span>.net
                </span>
            </a>

            <div class="hidden md:flex items-center space-x-8">

                <a href="/index.html" class="font-medium text-red-500 transition-colors duration-300"
                    data-i18n="title">Download
                    Shorts</a>
                <a href="/shorts-to-mp3.html"
                    class="font-medium text-slate-600 hover:text-red-500 transition-colors duration-300">MP3 Audio</a>

                <div class="relative group">
                    <button
                        class="font-medium text-slate-600 hover:text-red-500 transition-colors duration-300 flex items-center gap-2">
                        <span>AI Tools</span>
                        <i
                            class="fas fa-chevron-down text-xs transition-transform duration-300 group-hover:rotate-180"></i>
                    </button>
                    <div
                        class="absolute top-full left-1/2 -translate-x-1/2 mt-3 w-64 bg-white rounded-lg shadow-xl ring-1 ring-slate-900/5 p-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform group-hover:translate-y-0 -translate-y-2">
                        <a href="/no-watermark.html"
                            class="block w-full text-left px-4 py-2 rounded-md text-slate-700 hover:bg-slate-100 hover:text-red-500">Watermark
                            Remover</a>
                        <a href="/4k-shorts-downloader.html"
                            class="block w-full text-left px-4 py-2 rounded-md text-slate-700 hover:bg-slate-100 hover:text-red-500">4K
                            Shorts Downloader</a>
                        <a href="/shorts-thumbnail-tool.html"
                            class="block w-full text-left px-4 py-2 rounded-md text-slate-700 hover:bg-slate-100 hover:text-red-500">Shorts
                            Thumbnail Tool</a>
                    </div>
                </div>

                <div class="relative group">
                    <button
                        class="font-medium text-slate-600 hover:text-red-500 transition-colors duration-300 flex items-center gap-2">
                        <span>Guide</span>
                        <i
                            class="fas fa-chevron-down text-xs transition-transform duration-300 group-hover:rotate-180"></i>
                    </button>
                    <div
                        class="absolute top-full left-1/2 -translate-x-1/2 mt-3 w-64 bg-white rounded-lg shadow-xl ring-1 ring-slate-900/5 p-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform group-hover:translate-y-0 -translate-y-2">
                        <a href="/guide/chrome-extension.html"
                            class="block w-full text-left px-4 py-2 rounded-md text-slate-700 hover:bg-slate-100 hover:text-red-500">Chrome
                            Extension</a>
                        <a href="/guide/iphone-downloader.html"
                            class="block w-full text-left px-4 py-2 rounded-md text-slate-700 hover:bg-slate-100 hover:text-red-500">iPhone
                            Downloader</a>
                        <a href="/guide/latest-shorts-tool.html"
                            class="block w-full text-left px-4 py-2 rounded-md text-slate-700 hover:bg-slate-100 hover:text-red-500">Latest
                            Shorts Tool</a>
                    </div>
                </div>

                <a href="/pricing.html"
                    class="font-medium text-slate-600 hover:text-red-500 transition-colors duration-300">Pricing</a>

                <div class="relative group">
                    <button
                        class="font-medium text-slate-600 hover:text-red-500 transition-colors duration-300 flex items-center gap-2">
                        <span>Legal</span>
                        <i
                            class="fas fa-chevron-down text-xs transition-transform duration-300 group-hover:rotate-180"></i>
                    </button>
                    <div
                        class="absolute top-full left-1/2 -translate-x-1/2 mt-3 w-48 bg-white rounded-lg shadow-xl ring-1 ring-slate-900/5 p-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform group-hover:translate-y-0 -translate-y-2">
                        <a href="/privacy.html"
                            class="block w-full text-left px-4 py-2 rounded-md text-slate-700 hover:bg-slate-100 hover:text-red-500">Privacy
                            Policy</a>
                        <a href="/terms.html"
                            class="block w-full text-left px-4 py-2 rounded-md text-slate-700 hover:bg-slate-100 hover:text-red-500">Terms
                            of Service</a>
                    </div>
                </div>


                <a href="/addon.html"
                    class="font-medium text-slate-600 hover:text-red-500 transition-colors duration-300">Add-On</a>
                <a href="/about.html"
                    class="font-medium text-slate-600 hover:text-red-500 transition-colors duration-300">About</a>

            </div>

            <button id="mobile-menu-button" class="md:hidden text-2xl text-slate-600" aria-label="Open menu"
                aria-controls="mobile-drawer" aria-expanded="false">
                <i class="fas fa-bars"></i>
            </button>
        </nav>
    </header>

    <!-- Mobile Drawer & Backdrop (MOVED OUT OF HEADER) -->
    <div id="mobile-drawer-backdrop"
        class="fixed inset-0 bg-black/40 transition-opacity backdrop-hidden z-50 md:hidden">
    </div>
    <aside id="mobile-drawer"
        class="fixed top-0 right-0 h-full w-80 max-w-[80%] bg-white shadow-2xl translate-x-full transition-transform z-50 md:hidden"
        aria-hidden="true">
        <div class="p-4 border-b border-slate-200 flex items-center justify-between">
            <span class="text-xl font-semibold">Menu</span>
            <button id="mobile-menu-close" class="text-2xl text-slate-600" aria-label="Close menu">
                <i class="fas a-times"></i>
            </button>
        </div>
        <nav class="p-6 space-y-4 bg-white min-h-screen">
            <a href="/index.html" class="block font-medium text-red-500">Download Shorts</a>
            <a href="/shorts-to-mp3.html" class="block font-medium text-slate-600">MP3 Audio</a>
            <div>
                <div class="text-slate-400 text-xs uppercase tracking-wider mb-2">AI Tools</div>
                <a href="/no-watermark.html"
                    class="block px-2 py-2 rounded-md text-slate-700 hover:bg-slate-100">Watermark Remover</a>
                <a href="/4k-shorts-downloader.html"
                    class="block px-2 py-2 rounded-md text-slate-700 hover:bg-slate-100">4K Shorts Downloader</a>
                <a href="/shorts-thumbnail-tool.html"
                    class="block px-2 py-2 rounded-md text-slate-700 hover:bg-slate-100">Shorts Thumbnail Tool</a>
            </div>

            <div>
                <div class="text-slate-400 text-xs uppercase tracking-wider mb-2">Guide</div>
                <a href="/guide/chrome-extension.html"
                    class="block px-2 py-2 rounded-md text-slate-700 hover:bg-slate-100">Chrome Extension</a>
                <a href="/guide/iphone-downloader.html"
                    class="block px-2 py-2 rounded-md text-slate-700 hover:bg-slate-100">iPhone Downloader</a>
                <a href="/guide/latest-shorts-tool.html"
                    class="block px-2 py-2 rounded-md text-slate-700 hover:bg-slate-100">Latest Shorts Tool</a>
            </div>

            <a href="/pricing.html" class="block font-medium text-slate-600">Pricing</a>
            <div>
                <div class="text-slate-400 text-xs uppercase tracking-wider mb-2">Legal</div>
                <a href="/privacy.html" class="block px-2 py-2 rounded-md text-slate-700 hover:bg-slate-100">Privacy
                    Policy</a>
                <a href="/terms.html" class="block px-2 py-2 rounded-md text-slate-700 hover:bg-slate-100">Terms of
                    Service</a>
            </div>
            <a href="/addon.html" class="block font-medium text-slate-600">Add-On</a>
            <a href="/about.html" class="block font-medium text-slate-600">About</a>
        </nav>
    </aside>


    <!-- Main Content -->
    <main>
        <!-- Toast Notification Container -->
        <div id="toast-container"
            class="fixed top-24 left-1/2 -translate-x-1/2 z-[60] flex flex-col gap-2 pointer-events-none"></div>
        <section id="hero" class="relative py-16 md:py-30 text-center overflow-hidden">
            <div class="glow-effect"></div>
            <div
                class="container max-w-5xl mx-auto px-4 relative z-10 md:bg-white md:border md:border-slate-200 md:backdrop-blur-md md:p-12 md:rounded-xl md:shadow-lg">
                <h1
                    class="text-3xl md:text-5xl font-extrabold font-poppins leading-tight tracking-tighter text-slate-900">
                    Free YouTube Shorts Downloader: <br>The Ultimate Tool for Creators</h1>
                <p class="mt-4 text-md md:text-lg text-slate-600 max-w-3xl mx-auto font-medium"> HD MP4 and MP3
                    audio instantly. Clean and completely ad-free. </p>

                <!-- Mode Switch Tab -->
                <div class="mt-8 max-w-xs mx-auto flex bg-slate-100 p-1 rounded-xl shadow-inner" role="tablist">
                    <button id="mode-single" data-mode="single"
                        class="mode-switch-btn flex-1 py-2 font-bold text-sm rounded-lg bg-white text-red-600 shadow-md transition-all"
                        role="tab" aria-selected="true">
                        <i class="fas fa-link mr-2"></i> Single Download
                    </button>
                    <button id="mode-batch" data-mode="batch"
                        class="mode-switch-btn flex-1 py-2 font-bold text-sm rounded-lg text-slate-600 hover:text-red-600 transition-all"
                        role="tab" aria-selected="false">
                        <i class="fas fa-cubes mr-2"></i> Batch Download
                    </button>
                </div>

                <!-- Input Section -->
                <div id="input-section" class="mt-12 max-w-4xl mx-auto">
                    <div
                        class="flex flex-col md:flex-row items-center bg-white p-2 rounded-xl custom-ring custom-focus-ring transition-shadow duration-300 shadow-lg">
                        <div id="input-container" class="relative w-full">
                            <!-- Single Input -->
                            <div id="single-input-wrapper" class="w-full">
                                <i class="fas fa-link absolute left-2 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                <input id="single-input" type="url" placeholder="Paste your YouTube Shorts link here..."
                                    class="w-full h-12 pl-8 pr-10 bg-transparent focus:outline-none text-md text-slate-800 placeholder:text-slate-400"
                                    style="height: 48px;">
                                <button id="clear-single-input"
                                    class="absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 hidden">
                                    <i class="fas fa-times-circle"></i>
                                </button>
                            </div>
                            <!-- Batch Input -->
                            <div id="batch-input-wrapper" class="w-full hidden">
                                <i class="fas fa-list-ol absolute left-2 top-4 text-slate-400"></i>
                                <textarea id="batch-input" rows="5"
                                    placeholder="Paste multiple Shorts links here, separated by new lines or commas..."
                                    class="w-full pl-8 pr-10 pt-3 pb-3 bg-transparent focus:outline-none text-md text-slate-800 placeholder:text-slate-400 resize-none"
                                    style="height: 120px;"></textarea>
                                <button id="clear-batch-input"
                                    class="absolute right-2 top-4 text-slate-400 hover:text-slate-600 hidden">
                                    <i class="fas fa-times-circle"></i>
                                </button>
                            </div>
                        </div>
                        <!-- CTA Button -->
                        <button id="download-btn" data-current-mode="single" class="w-full md:w-auto mt-2 md:mt-0 
                            bg-red-500 text-white font-bold text-lg px-6 py-3 rounded-lg flex-shrink-0 
                            transition-all duration-300 transform hover:-translate-y-0.5 
                            hover:shadow-lg flex items-center justify-center space-x-3" style="height: 48px;">
                            <i class="fas fa-download"></i>
                            <span id="download-btn-text">Convert & Download</span>
                        </button>
                    </div>
                    <p id="input-help" class="mt-2 text-sm text-slate-500">Supports links like:
                        https://www.youtube.com/shorts/XXXXXXXXXXX</p>
                    <p id="input-error" class="mt-2 text-sm text-red-600 hidden">Please enter a valid YouTube Shorts
                        link.</p>
                </div>

                <div class="text-center px-2 mt-8">
                    <p> Need to remove watermarks or download 4K? <a href="/pricing.html"
                            class="font-bold text-red-500 underline hover:text-red-700">Unlock our AI Creator Suite!</a>
                    </p>
                </div>

                <!-- Result Section (for both single and batch) -->
                <div id="result-section" class="mt-12 max-w-4xl mx-auto hidden" aria-live="polite" aria-busy="false">
                </div>
            </div>
        </section>


        <section class="py-8 bg-white border-y border-slate-200/80">
            <div class="container mx-auto px-6 max-w-4xl">

                <p
                    class="font-semibold text-xl text-slate-800 list-none flex justify-between items-center cursor-pointer hover:text-primary transition-colors duration-300">
                    Simple 3-Step Guide to Convert Shorts to MP3

                </p>
                <div class="pt-8">
                    <div class="flex flex-col md:flex-row md:space-x-8 space-y-8 md:space-y-0 relative">

                        <div
                            class="flex-1 flex items-start space-x-4 md:flex-col md:space-x-0 md:items-center text-center">

                            <div class="md:mt-4">
                                <h3 class="text-xl font-bold text-slate-800 mb-1">1. Copy the Link</h3>
                                <p class="text-slate-600 text-left md:text-center">Find the YouTube Short video you
                                    need and copy its
                                    URL.</p>
                            </div>
                        </div>

                        <div class="hidden md:flex items-center justify-center">
                            <i class="fas fa-chevron-right text-3xl text-slate-300" aria-hidden="true"></i>
                        </div>

                        <div
                            class="flex-1 flex items-start space-x-4 md:flex-col md:space-x-0 md:items-center text-center">

                            <div class="md:mt-4">
                                <h3 class="text-xl font-bold text-slate-800 mb-1">2. Select MP3</h3>
                                <p class="text-slate-600 text-left md:text-center">Paste the URL into the box above
                                    and ensure 'MP3' is
                                    selected.</p>
                            </div>
                        </div>

                        <div class="hidden md:flex items-center justify-center">
                            <i class="fas fa-chevron-right text-3xl text-slate-300" aria-hidden="true"></i>
                        </div>

                        <div
                            class="flex-1 flex items-start space-x-4 md:flex-col md:space-x-0 md:items-center text-center">

                            <div class="md:mt-4">
                                <h3 class="text-xl font-bold text-slate-800 mb-1">3. Download
                                </h3>
                                <p class="text-slate-600 text-left md:text-center">Hit the button. The high-quality
                                    audio file is saved
                                    instantly to your device.</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <!-- MODIFICATION 2 (STYLE): Added a background color to create visual rhythm and highlight this trust-building section -->
        <section id="features" class="py-24 bg-slate-100">
            <div class="container max-w-6xl mx-auto px-6">
                <div class="grid md:grid-cols-2 gap-16 items-center">
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold font-poppins text-slate-900 mb-5">The Fastest and
                            Most<br>Secure Shorts Download Experience</h2>
                        <h3 class="text-xl font-semibold text-slate-700 mb-8">Our promise: Always faster and more
                            reliable than the competition.</h3>
                        <div class="flex items-center gap-6 mb-8 p-6 bg-white rounded-xl border-l-4 border-red-500">
                            <strong class="text-3xl md:text-4xl font-extrabold font-poppins text-red-500">23%</strong>
                            <p class="text-slate-600 font-medium leading-tight">Faster average conversion time than top
                                competitors (e.g., Savetube & Y2mate).</p>
                        </div>
                        <p class="text-slate-600 leading-relaxed mb-6">We developed ShortsSync because other tools on
                            the market were too slow or unreliable. Our custom protocol ensures maximum speed through:
                        </p>
                        <ul class="space-y-4">
                            <li class="flex items-start"><i class="fas fa-bolt-lightning text-red-500 mt-1 mr-4"></i>
                                <div><strong class="text-slate-800">Priority Link Parsing:</strong> We process your link
                                    instantly, with no waiting time.</div>
                            </li>
                            <li class="flex items-start"><i class="fas fa-ban text-red-500 mt-1 mr-4"></i>
                                <div><strong class="text-slate-800">Invasive Ad Blocking:</strong> No heavy ad scripts
                                    means a smoother experience for you.</div>
                            </li>
                        </ul>
                    </div>
                    <div class="relative group">
                        <div
                            class="absolute -inset-2 bg-gradient-to-br from-red-500 to-orange-500 rounded-2xl blur-lg opacity-25 group-hover:opacity-40 transition duration-500">
                        </div>
                        <div class="relative bg-white p-4 rounded-2xl shadow-2xl">
                            <img src="./images/Promise.webp" alt="A visual promise of speed and reliability"
                                class="rounded-xl w-full transition-transform duration-500 group-hover:scale-105">
                            <div
                                class="absolute -bottom-5 -right-5 bg-white/80 backdrop-blur-sm p-4 rounded-xl shadow-xl">
                                <figcaption class="text-sm text-slate-600 italic font-medium">Trust speed, not just
                                    promises.</figcaption>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-24 bg-white">
            <div class="container max-w-6xl mx-auto px-6 space-y-24">
                <div class="grid md:grid-cols-1 gap-8 items-center">
                    <div class="text-left">
                        <h2 class="text-3xl md:text-4xl font-bold font-poppins text-slate-900 mb-5">Supported
                            Formats:<br>MP4, MP3, and HD Quality</h2>
                        <p class="text-slate-600 text-lg leading-relaxed mb-10">We don't just download; we ensure your
                            videos meet all content repurposing requirements.</p>
                        <div class="grid sm:grid-cols-2 gap-8">
                            <div
                                class="bg-white p-8 rounded-2xl shadow-xl shadow-slate-200/50 border border-transparent transition-all duration-300 transform hover:-translate-y-2 hover:shadow-red-500/20 hover:border-red-500/30">
                                <div class="w-16 h-16 mb-6 flex items-center justify-center bg-red-100 rounded-xl">
                                    <i class="fas fa-file-video text-3xl text-red-500"></i>
                                </div>
                                <h3 class="text-2xl font-bold text-slate-800 mb-3">High-Quality MP4</h3>
                                <p class="text-slate-600 leading-relaxed">Download in Standard HD or Full HD. For higher
                                    quality, check our <a href="/4k-shorts-downloader.html"
                                        class="text-red-500 font-semibold hover:underline">4K/8K Pro Options</a>.</p>
                            </div>
                            <div
                                class="bg-white p-8 rounded-2xl shadow-xl shadow-slate-200/50 border border-transparent transition-all duration-300 transform hover:-translate-y-2 hover:shadow-red-500/20 hover:border-red-500/30">
                                <div class="w-16 h-16 mb-6 flex items-center justify-center bg-red-100 rounded-xl">
                                    <i class="fas fa-file-audio text-3xl text-red-500"></i>
                                </div>
                                <h3 class="text-2xl font-bold text-slate-800 mb-3">MP3 Audio Extraction</h3>
                                <p class="text-slate-600 leading-relaxed">Instantly separate the audio track for remixes
                                    or sound design, without any extra conversion tools.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-x-16 gap-y-10 items-center">
                    <div class="text-left">
                        <h2 class="text-3xl md:text-4xl font-bold font-poppins text-slate-900 mb-5">Why an Online Tool
                            Over an<br>Extension or App?</h2>
                        <p class="text-slate-600 text-lg leading-relaxed">Security, speed, and simplicity are key.
                            Here's why our online tool is the future of content repurposing:</p>
                    </div>
                    <div class="bg-white p-8 rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-200/60">
                        <ul class="space-y-6">
                            <li class="flex items-start">
                                <div
                                    class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-orange-100 rounded-lg mr-5">
                                    <i class="fas fa-rocket text-xl text-orange-500"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold text-lg text-slate-800">Zero Installation, Instant Start</h3>
                                    <p class="text-slate-600 leading-relaxed mt-1">No malware or browser plugins. Just a
                                        clean, fast tool that works instantly.</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <div
                                    class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-orange-100 rounded-lg mr-5">
                                    <i class="fas fa-globe text-xl text-orange-500"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold text-lg text-slate-800">Universal Compatibility</h3>
                                    <p class="text-slate-600 leading-relaxed mt-1">Works seamlessly on iOS, Android, PC,
                                        and Mac. No need for a dedicated app download.</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <div
                                    class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-orange-100 rounded-lg mr-5">
                                    <i class="fas fa-user-shield text-xl text-orange-500"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold text-lg text-slate-800">Guaranteed Privacy</h3>
                                    <p class="text-slate-600 leading-relaxed mt-1">Server-side processing means we
                                        <strong>never
                                    </p>strong> touch, view, or store your files.</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-24 bg-slate-50 border-y border-slate-200/80">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold font-poppins text-slate-900">Go Beyond Downloading with AI
                    </h2>
                    <p class="mt-4 text-lg text-slate-600 leading-relaxed">Unlock our Creator Suite to optimize and
                        repurpose your content like never before.</p>
                </div>
                <div
                    class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-200/60 divide-y divide-slate-200">
                    <div
                        class="p-8 grid md:grid-cols-[auto,1fr,auto] items-center gap-6 hover:bg-slate-50 transition-colors duration-300">
                        <div class="w-12 h-12 flex-shrink-0 flex items-center justify-center bg-red-100 rounded-lg">
                            <i class="fas fa-wand-magic-sparkles text-2xl text-red-500"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-slate-800 mb-1">AI Watermark Remover</h3>
                            <p class="text-slate-600 leading-relaxed">Instantly remove watermarks for seamless
                                cross-platform sharing.</p>
                        </div>
                        <a href="/no-watermark.html"
                            class="px-5 py-2 text-center font-semibold text-slate-700 bg-slate-200 rounded-lg hover:bg-red-500 hover:text-white transition-all duration-300 group">Learn
                            More <i
                                class="fas fa-arrow-right ml-1 opacity-0 -translate-x-1 group-hover:opacity-100 group-hover:translate-x-0 transition-all"></i></a>
                    </div>
                    <div
                        class="p-8 grid md:grid-cols-[auto,1fr,auto] items-center gap-6 hover:bg-slate-50 transition-colors duration-300">
                        <div class="w-12 h-12 flex-shrink-0 flex items-center justify-center bg-red-100 rounded-lg">
                            <i class="fas fa-file-alt text-2xl text-red-500"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-slate-800 mb-1">Transcript Generator</h3>
                            <p class="text-slate-600 leading-relaxed">Get the full text of any Short for instant blog
                                posts or captions.</p>
                        </div>
                        <a href="/pricing.html"
                            class="px-5 py-2 text-center font-semibold text-slate-700 bg-slate-200 rounded-lg hover:bg-red-500 hover:text-white transition-all duration-300 group">Get
                            Transcript <i
                                class="fas fa-arrow-right ml-1 opacity-0 -translate-x-1 group-hover:opacity-100 group-hover:translate-x-0 transition-all"></i></a>
                    </div>
                </div>
            </div>
        </section>
        <!-- MODIFICATION 3 (TEXT): NEW Social Proof (Testimonial) section added to build trust and relatability -->
        <section class="py-24 bg-slate-50 border-y border-slate-200/80">
            <div class="container max-w-4xl mx-auto px-6 text-center">
                <i class="fas fa-quote-left text-5xl text-slate-300"></i>
                <blockquote class="mt-6">
                    <p class="text-xl md:text-2xl font-medium text-slate-800 italic leading-relaxed">
                        "YTShortsDL is a lifesaver. The AI watermark remover saves me at least 2 hours every week. It's
                        not an expense; it's an investment in my workflow."
                    </p>
                </blockquote>
                <figcaption class="mt-8">
                    <p class="font-bold text-lg text-slate-900">Alex P., Social Media Manager</p>
                    <p class="text-sm text-slate-500">Pragmatic Creator</p>
                </figcaption>
            </div>
        </section>

        <!-- MODIFICATION 3 (TEXT): Final CTA copy updated for emotional connection and inspiration -->
        <section class="py-24">
            <div class="container mx-auto px-6 text-center">
                <div
                    class="bg-gradient-to-r from-slate-800 to-slate-900 text-white p-12 rounded-2xl shadow-2xl relative overflow-hidden">
                    <div
                        class="absolute -top-1/4 -right-1/4 w-80 h-80 bg-red-500/20 rounded-full filter blur-3xl opacity-50">
                    </div>
                    <div class="relative z-10">
                        <h2 class="text-3xl md:text-4xl font-bold font-poppins text-white">Stop Just Downloading. Start
                            Creating.</h2>
                        <p class="mt-4 text-lg text-slate-300 max-w-2xl mx-auto leading-relaxed">Unlock the full
                            potential of your content. Go from a simple video to a multi-platform asset with our
                            AI-powered Creator Suite.</p>
                        <a href="/pricing.html"
                            class="mt-10 inline-block bg-red-500 text-white font-bold text-lg px-10 py-4 rounded-lg transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl hover:shadow-red-500/40">Explore
                            the AI Suite</a>
                    </div>
                </div>
            </div>
        </section>

        <section id="faq" class="py-24 border-t border-slate-200/80 bg-white">
            <div class="container max-w-5xl mx-auto px-6  ">
                <h2 class="text-3xl md:text-4xl font-bold font-poppins text-slate-900 mb-10">Frequently Asked Questions
                    (FAQ)</h2>
                <div class="space-y-4">
                    <details
                        class="bg-white p-6 rounded-lg group shadow-lg border border-slate-200/50 shadow-slate-200/50">
                        <summary
                            class="font-semibold text-lg text-slate-800 list-none flex justify-between items-center cursor-pointer">
                            Is this YouTube Shorts Downloader completely free?<i
                                class="fas fa-chevron-down transition-transform duration-300 group-open:rotate-180"></i>
                        </summary>
                        <p class="mt-4 text-slate-600 leading-relaxed">Yes, the core download functionality (up to 1080P
                            HD) is <strong>100% free </strong>. We offer a paid subscription for premium features like
                            4K downloads
                            and our AI Watermark Remover tool.</p>
                    </details>
                    <details
                        class="bg-white p-6 rounded-lg group shadow-lg border border-slate-200/50 shadow-slate-200/50">
                        <summary
                            class="font-semibold text-lg text-slate-800 list-none flex justify-between items-center cursor-pointer">
                            Will the YouTube watermark be preserved when I download?<i
                                class="fas fa-chevron-down transition-transform duration-300 group-open:rotate-180"></i>
                        </summary>
                        <p class="mt-4 text-slate-600 leading-relaxed">The free download retains the watermark. We offer
                            a premium, paid AI feature specifically designed to remove watermarks for seamless
                            cross-platform sharing. <a href="/no-watermark.html"
                                class="text-red-500 font-semibold hover:underline">Learn more here.</a></p>
                    </details>
                    <details
                        class="bg-white p-6 rounded-lg group shadow-lg border border-slate-200/50 shadow-slate-200/50">
                        <summary
                            class="font-semibold text-lg text-slate-800 list-none flex justify-between items-center cursor-pointer">
                            Is this tool safe to use?<i
                                class="fas fa-chevron-down transition-transform duration-300 group-open:rotate-180"></i>
                        </summary>
                        <p class="mt-4 text-slate-600 leading-relaxed">Absolutely. We use secure, server-side processing
                            methods. Your privacy is fully guaranteed, and we do not store your files or personal data.
                        </p>
                    </details>
                </div>
            </div>
        </section>

    </main>
    <!-- Footer -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="container mx-auto px-6 py-16">

            <div class="grid md:grid-cols-5 gap-8">

                <div class="md:col-span-1">
                    <a href="/" class="text-2xl font-bold font-poppins">
                        YTShorts<span class="text-red-500">dl</span>.net
                    </a>
                    <p class="mt-4 text-sm text-slate-400 leading-relaxed">
                        The ultimate tool for creators to download, optimize, and repurpose their YouTube Shorts
                        content. Fast, free, and built with passion.
                    </p>
                </div>

                <div>
                    <h3 class="font-semibold text-white mb-4">Core Tools</h3>
                    <ul class="space-y-3">
                        <li><a href="/index.html" class="hover:text-red-500 transition-colors">Download Shorts</a></li>
                        <li><a href="/shorts-to-mp3.html" class="hover:text-red-500 transition-colors">MP3 Audio</a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold text-white mb-4">Guide</h3>
                    <ul class="space-y-3">
                        <li><a href="/guide/chrome-extension.html" class="hover:text-red-500 transition-colors">Chrome
                                Extension</a></li>
                        <li><a href="/guide/shorts-to-mp3.html" class="hover:text-red-500 transition-colors">MP3
                                Audio</a></li>
                        <li><a href="/guide/no-watermark.html" class="hover:text-red-500 transition-colors">Watermark
                                Removal</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold text-white mb-4">AI Tools</h3>
                    <ul class="space-y-3">
                        <li><a href="/no-watermark.html" class="hover:text-red-500 transition-colors">Watermark
                                Remover</a></li>
                        <li><a href="/4k-shorts-downloader.html" class="hover:text-red-500 transition-colors">4K Shorts
                                Downloader</a></li>
                        <li><a href="/shorts-thumbnail-tool.html" class="hover:text-red-500 transition-colors">Shorts
                                Thumbnail Tool</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-semibold text-white mb-4">Company</h3>
                    <ul class="space-y-3">

                        <li><a href="/addon.html" class="hover:text-red-500 transition-colors">Add-on</a></li>
                        <li><a href="/about.html" class="hover:text-red-500 transition-colors">About & Contact</a></li>
                        <li><a href="/pricing.html" class="hover:text-red-500 transition-colors">Pricing</a></li>
                        <li><a href="/privacy.html" class="hover:text-red-500 transition-colors">Privacy Policy</a></li>
                        <li><a href="/terms.html" class="hover:text-red-500 transition-colors">Terms of Service</a></li>
                    </ul>
                </div>

            </div>

            <div class="mt-12 pt-8 border-t border-slate-700 flex flex-col sm:flex-row justify-between items-center">
                <p class="text-sm text-slate-400">&copy; 2025 YTShortsdl.net. All rights reserved.</p>
                <div class="flex space-x-4 mt-4 sm:mt-0">
                    <a href="#" class="text-slate-400 hover:text-red-500 transition-colors"><i
                            class="fab fa-twitter text-xl"></i></a>
                    <a href="#" class="text-slate-400 hover:text-red-500 transition-colors"><i
                            class="fab fa-youtube text-xl"></i></a>
                    <a href="#" class="text-slate-400 hover:text-red-500 transition-colors"><i
                            class="fab fa-github text-xl"></i></a>
                </div>
            </div>

        </div>
    </footer>


    <script>
        // ====================================================================
        // START: JAVASCRIPT FOR DYNAMIC FUNCTIONALITY
        // ====================================================================

        // API Configuration
        // FIX: Pointing to Localhost because you are running the Python backend locally.
        const API_BASE_URL = 'https://ytdlp.vistaflyer.com';

        // Element References
        const singleInput = document.getElementById('single-input'),
            batchInput = document.getElementById('batch-input'),
            singleWrapper = document.getElementById('single-input-wrapper'),
            batchWrapper = document.getElementById('batch-input-wrapper'),
            clearSingleBtn = document.getElementById('clear-single-input'),
            clearBatchBtn = document.getElementById('clear-batch-input'),
            downloadButton = document.getElementById('download-btn'),
            resultSection = document.getElementById('result-section'),
            inputError = document.getElementById('input-error'),
            inputHelp = document.getElementById('input-help'),
            modeSwitchBtns = document.querySelectorAll('.mode-switch-btn'),
            inputSection = document.getElementById('input-section'),
            mobileMenuBtn = document.getElementById('mobile-menu-button'),
            mobileMenuClose = document.getElementById('mobile-menu-close'),
            mobileDrawer = document.getElementById('mobile-drawer'),
            mobileBackdrop = document.getElementById('mobile-drawer-backdrop');

        // Batch Task State
        let batchPollingInterval = null;

        // --- Core Helpers ---
        const isValidYouTubeUrl = (value) => { try { const url = new URL(value.trim()); const host = url.hostname.replace(/^www\./, ''); return ['youtube.com', 'm.youtube.com', 'youtu.be'].includes(host); } catch { return false; } };
        const showError = (message) => { inputError.textContent = message; inputError.classList.remove('hidden'); };
        const clearError = () => inputError.classList.add('hidden');
        const extractAndValidateLinks = (text) => { const lines = text.trim().replace(/,/g, '\n').split('\n'); const validLinks = new Set(); lines.forEach(line => { const trimmed = line.trim(); if (trimmed && isValidYouTubeUrl(trimmed)) { validLinks.add(trimmed); } }); return Array.from(validLinks); };
        // --- Toast Notification Helper (Replaces alert) ---
        function showToast(message, type = 'error') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');

            // 根据类型设置颜色 (error=红色, success=绿色)
            const bgClass = type === 'error' ? 'bg-red-600' : 'bg-green-600';
            const iconClass = type === 'error' ? 'fa-exclamation-circle' : 'fa-check-circle';

            toast.className = `${bgClass} text-white px-6 py-4 rounded-lg shadow-xl flex items-center gap-3 transition-all duration-300 transform translate-y-[-20px] opacity-0 pointer-events-auto min-w-[300px] max-w-[90vw]`;
            toast.innerHTML = `
        <i class="fas ${iconClass} text-lg"></i>
        <span class="font-medium text-sm md:text-base">${message}</span>
    `;

            container.appendChild(toast);

            // 动画显示
            requestAnimationFrame(() => {
                toast.classList.remove('translate-y-[-20px]', 'opacity-0');
            });

            // 3秒后自动消失
            setTimeout(() => {
                toast.classList.add('opacity-0', '-translate-y-2');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        // --- UI & Mode Switching ---
        function setLoading(state, mode, text = '') {
            if (state) {
                downloadButton.innerHTML = `<i class="fas fa-spinner fa-spin"></i><span>${text || (mode === 'batch' ? 'Processing...' : 'Processing...')}</span>`;
                downloadButton.disabled = true;
            } else {
                downloadButton.innerHTML = mode === 'batch'
                    ? `<i class="fas fa-search"></i><span>Analyze Links</span>`
                    : `<i class="fas fa-download"></i><span>Convert & Download</span>`;
                downloadButton.disabled = false;
            }
        }

        function switchMode(mode) {
            downloadButton.dataset.currentMode = mode;
            clearError();
            resultSection.innerHTML = '';
            resultSection.classList.add('hidden');
            inputSection.classList.remove('hidden');
            if (batchPollingInterval) clearInterval(batchPollingInterval);

            modeSwitchBtns.forEach(btn => {
                const isTarget = btn.dataset.mode === mode;
                btn.classList.toggle('bg-white', isTarget);
                btn.classList.toggle('text-red-600', isTarget);
                btn.classList.toggle('shadow-md', isTarget);
                btn.classList.toggle('text-slate-600', !isTarget);
            });

            const isSingle = mode === 'single';
            singleWrapper.classList.toggle('hidden', !isSingle);
            batchWrapper.classList.toggle('hidden', isSingle);
            inputHelp.textContent = isSingle ? "Supports links like: https://www.youtube.com/shorts/XXXXXXXXXXX" : "Enter one link per line or separate by commas.";
            downloadButton.style.height = isSingle ? '48px' : '120px';
            (isSingle ? singleInput : batchInput).focus();
            setLoading(false, mode);
        }

        // --- RENDER FUNCTIONS (FOR BOTH MODES) ---

        function renderSkeleton() {
            return `
            <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 text-left animate-pulse">
                
                <div class="flex flex-col md:flex-row gap-6 mb-8">
                    <div class="w-full md:w-48 h-28 bg-slate-200 rounded-lg"></div>
                    <div class="flex-1 space-y-3 py-2">
                        <div class="h-6 w-3/4 bg-slate-200 rounded"></div>
                        <div class="h-4 w-1/2 bg-slate-200 rounded"></div>
                        <div class="h-4 w-1/4 bg-slate-200 rounded mt-2"></div>
                    </div>
                </div>
 
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8"> 
                    <div class="md:col-span-2 space-y-4">
                        <div class="flex gap-4 mb-6 border-b border-slate-200 pb-2">
                            <div class="h-8 w-24 bg-slate-200 rounded"></div>
                            <div class="h-8 w-24 bg-slate-200 rounded"></div>
                        </div>
                        <div class="h-12 w-full bg-slate-200 rounded-lg"></div>
                        <div class="h-12 w-full bg-slate-200 rounded-lg"></div>
                        <div class="h-12 w-full bg-slate-200 rounded-lg"></div>
                        <div class="h-12 w-full bg-slate-200 rounded-lg"></div>
                    </div>

                    <!-- 右侧 (占1列): PRO 工具推广位 -->
                    <div class="md:col-span-1 hidden md:block">
                        <div class="h-64 w-full bg-slate-100 rounded-xl border border-slate-200"></div>
                    </div>
                </div>
            </div>`;
        }

        function renderSingleResults(data) {
            // 1. 解构数据
            const title = data.title || 'Unknown Title';
            const thumbnail = data.thumbnail || '';
            const uploader = data.uploader || 'Unknown Author';
            const duration = data.duration || 0;
            const url = data.url;
            const formats = data.formats || [];
            // NEW: Extract subtitles from backend response
            const subtitles = data.subtitles || [];

            // 2. 分类格式
            const videoFormats = formats.filter(f => f.resolution && f.resolution !== 'Audio Only (MP3)' && f.resolution !== 'MP3');
            const audioFormats = formats.filter(f => !f.resolution || f.resolution === 'Audio Only (MP3)' || f.resolution === 'MP3');

            // 3. 辅助函数：生成列表项 HTML
            const renderFormats = (fmtList, type) => {
                if (!fmtList || fmtList.length === 0) {
                    return `<div class="p-4 text-sm text-slate-500 text-center italic bg-slate-50 rounded-lg">No ${type} formats available.</div>`;
                }
                return fmtList.map(f => {
                    const isAudio = type === 'audio';
                    const iconClass = isAudio ? 'fa-music' : 'fa-video';
                    const labelText = f.resolution || 'High Quality Audio';
                    const fileSizeText = f.filesize ? `${(f.filesize / 1024 / 1024).toFixed(2)} MB` : 'N/A';

                    return `
                    <div class="flex items-center justify-between p-3 mb-2 bg-white rounded-lg shadow-sm border border-slate-100 hover:bg-slate-50 transition-colors">
                        <div class="flex items-center gap-3 overflow-hidden">
                            <div class="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0 text-red-500">
                                <i class="fas ${iconClass}"></i>
                            </div>
                            <div class="font-medium text-slate-700 text-sm truncate">${labelText}</div>
                        </div>
                        <div class="flex items-center gap-3 flex-shrink-0">
                            <span class="text-xs text-slate-400 w-16 text-right font-mono hidden sm:block">${fileSizeText}</span>
                            <button class="download-link-btn bg-red-500 text-white font-semibold px-4 py-1.5 rounded-md text-xs hover:bg-red-600 transition-colors shadow-sm" 
                                data-url="${url}" 
                                data-title="${title}"
                                data-format-id="${f.format_id}">
                                Download
                            </button>
                        </div>
                    </div>`;
                }).join('');
            };

            // NEW: Render Subtitles List with Split Button (SRT | TXT)
            const renderSubtitlesList = (subs) => {
                if (!subs || subs.length === 0) {
                    return `<div class="p-4 text-sm text-slate-500 text-center italic bg-slate-50 rounded-lg">No subtitles found.</div>`;
                }
                return subs.map(s => {
                    const labelText = `${s.name} (${s.lang_code.toUpperCase()})`;
                    // Split button design: Left for SRT (Main), Right for Toggle Menu (TXT)
                    // Simplified for Vanilla JS: Just a toggle menu that shows TXT option
                    return `
                    <div class="flex items-center justify-between p-2 mb-2 bg-white rounded border border-slate-100 text-sm hover:bg-slate-50 transition-colors">
                        <div class="flex items-center gap-2">
                             <i class="fas fa-closed-captioning text-slate-400"></i>
                             <span class="text-slate-700 font-medium">${labelText}</span>
                             ${s.is_auto ? '<span class="text-[10px] bg-slate-100 text-slate-500 px-1 rounded">Auto</span>' : ''}
                        </div>
                        
                        <div class="relative flex items-center group-dropdown">
                            <!-- Main Action: Download SRT -->
                            <button class="download-link-btn flex items-center bg-white border border-slate-300 text-slate-700 hover:text-red-500 hover:border-red-400 text-xs font-semibold px-3 py-1.5 rounded-l-md transition-colors" 
                                    title="Download .srt"
                                    data-url="${url}" 
                                    data-title="${title}_${s.lang_code}"
                                    data-format-id="sub_srt_${s.lang_code}">
                                <i class="fas fa-download mr-1"></i> .SRT
                            </button>
                            
                            <!-- Toggle Action: Show Menu for TXT -->
                             <button class="menu-toggle-btn flex items-center bg-slate-50 border-t border-b border-r border-slate-300 text-slate-600 hover:text-red-500 hover:bg-white text-xs font-semibold px-2 py-1.5 rounded-r-md transition-colors"
                                     onclick="this.nextElementSibling.classList.toggle('hidden')">
                                <i class="fas fa-chevron-down"></i>
                            </button>

                            <!-- Dropdown Menu -->
                            <div class="absolute right-0 top-full mt-1 w-40 bg-white border border-slate-200 shadow-lg rounded-md z-10 hidden" onmouseleave="this.classList.add('hidden')">
                                <button class="download-link-btn block w-full text-left px-4 py-2 text-xs text-slate-700 hover:bg-slate-50 hover:text-red-500"
                                        data-url="${url}" 
                                        data-title="${title}_${s.lang_code}"
                                        data-format-id="sub_txt_${s.lang_code}">
                                    <i class="fas fa-file-alt mr-2"></i> Plain Text (.txt)
                                </button>
                            </div>
                        </div>
                    </div>`;
                }).join('');
            };

            // NEW: Render AI Summary Tab UI
            const renderSummaryTab = (subs) => {
                if (!subs || subs.length === 0) {
                    return `<div class="p-4 text-sm text-slate-500 text-center italic bg-slate-50 rounded-lg">No subtitles found for this video. Cannot generate summary.</div>`;
                }

                // Smart Default Language Selection
                const userLang = navigator.language.split('-')[0]; // e.g. 'en' from 'en-US'
                let defaultSub = subs.find(s => s.lang_code === userLang);
                if (!defaultSub) defaultSub = subs.find(s => s.lang_code.startsWith('en'));
                if (!defaultSub) defaultSub = subs[0];

                const optionsHtml = subs.map(s => {
                    const isSelected = (defaultSub && s.lang_code === defaultSub.lang_code) ? 'selected' : '';
                    const label = `${s.name} (${s.lang_code.toUpperCase()}) ${s.is_auto ? '[Auto]' : ''}`;
                    return `<option value="${s.lang_code}" ${isSelected}>${label}</option>`;
                }).join('');

                return `
                <div class="bg-red-50 p-4 rounded-lg border border-red-100 mb-6">
                    <h4 class="font-bold text-slate-600 mb-3 flex items-center">
                        <i class="fas fa-robot mr-2"></i> AI Video Summary
                    </h4>
                    <div class="flex flex-col sm:flex-row gap-3">
                        <select id="summary-lang-select" class="flex-1 p-2.5 rounded-lg border border-red-200 text-sm focus:ring-2 focus:ring-red-500 outline-none">
                            ${optionsHtml}
                        </select>
                        <button id="btn-generate-summary" data-url="${url}" class="bg-red-500 text-white font-bold px-6 py-2.5 rounded-lg hover:bg-red-700 transition-colors shadow-sm flex items-center justify-center gap-2">
                            <i class="fas fa-magic"></i> Generate Summary
                        </button>
                    </div>
                    <div id="summary-container" class="mt-4 hidden">
                         <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-inner min-h-[120px] max-h-[400px] overflow-y-auto">
                            <!-- Changed to DIV to support Markdown rendering -->
                            <div id="summary-text-output" class="text-slate-700 text-sm leading-relaxed font-sans"></div>
                            <span id="summary-cursor" class="inline-block w-1.5 h-4 bg-red-500 ml-1 animate-pulse align-middle"></span>
                         </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <h5 class="font-semibold text-slate-700 text-sm mb-2 px-1 flex justify-between items-center">
                        <span>Subtitle Downloads</span>
                        <span class="text-xs font-normal text-slate-500 bg-slate-100 px-2 py-0.5 rounded">SRT & TXT Supported</span>
                    </h5>
                    <div class="max-h-60 overflow-y-auto custom-scrollbar border border-slate-100 rounded-lg p-2 bg-slate-50">
                        ${renderSubtitlesList(subs)}
                    </div>
                </div>
                `;
            };

            // 4. 渲染主布局 (Updated with AI Summary Tab)
            resultSection.innerHTML = `
            <div class="bg-white p-4 text-left rounded-2xl">
                <!-- 顶部: 视频信息 -->
                <div class="flex flex-col md:flex-row gap-6 items-start border-b border-slate-100 pb-8">
                    <img src="${thumbnail}" alt="${title}" class="w-full md:w-48 h-auto rounded-lg object-cover shadow-lg border bg-slate-100">
                    <div class="flex-1 overflow-hidden">
                        <h3 class="text-2xl font-bold font-poppins text-slate-800 leading-tight">${title}</h3>
                       
                    </div>
                </div>

                <!-- 底部: Grid 布局 (左侧下载列表，右侧 Creator Suite) -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    
                    <!-- 左列: 下载格式选项 (占 2/3) -->
                    <div class="md:col-span-2">
                        <div class="md:bg-slate-50 md:p-4 md:rounded-xl border border-transparent md:border-slate-200 h-full">
                            <!-- Tabs (Updated with Summary Tab) -->
                            <div class="flex flex-wrap gap-2 border-b border-slate-300 mb-4 pb-1" role="tablist">
                                <button data-tab="video" class="tab-button font-bold px-4 py-2 text-sm border-b-2 border-red-500 text-red-600 transition-colors focus:outline-none">
                                    <i class="fas fa-video mr-1"></i> Video (${videoFormats.length})
                                </button>
                                <button data-tab="audio" class="tab-button font-bold px-4 py-2 text-sm border-b-2 border-transparent text-slate-600 hover:text-red-500 transition-colors focus:outline-none">
                                    <i class="fas fa-music mr-1"></i> Audio (${audioFormats.length})
                                </button>
                                <button data-tab="summary" class="tab-button font-bold px-4 py-2 text-sm border-b-2 border-transparent text-slate-600 hover:text-slate-600 transition-colors focus:outline-none">
                                    <i class="fas fa-wand-magic-sparkles mr-1"></i> AI Summary (${subtitles.length})
                                </button>
                            </div>
                            
                            <!-- Video Content -->
                            <div data-content="video" class="tab-content space-y-2">
                                ${renderFormats(videoFormats, 'video')}
                            </div>
                            
                            <!-- Audio Content -->
                            <div data-content="audio" class="tab-content space-y-2 hidden">
                                ${renderFormats(audioFormats, 'audio')}
                            </div>

                            <!-- NEW: Summary/Subtitle Content -->
                            <div data-content="summary" class="tab-content space-y-2 hidden">
                                ${renderSummaryTab(subtitles)}
                            </div>
                        </div>
                    </div>

                    <!-- 右列: Creator Suite PRO (占 1/3) -->
                    <div class="md:col-span-1">
                        <div class="bg-gradient-to-br from-red-50 to-blue-50 p-6 rounded-xl border border-red-100 h-fit shadow-sm sticky top-24">
                            <h4 class="font-semibold text-lg mb-4 flex items-center text-slate-700">
                                <i class="fas fa-wand-magic-sparkles text-red-500 mr-2"></i> Creator Suite 
                                <span class="ml-2 text-[10px] font-bold bg-red-500 text-white px-2 py-0.5 rounded-full tracking-wider">PRO</span>
                            </h4>
                            <div class="space-y-3">
                                <a href="/no-watermark.html" class="flex items-center p-3 bg-white rounded-lg shadow-sm hover:shadow-md hover:border-red-500 border border-transparent transition group">
                                    <div class="w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center mr-3 group-hover:scale-110 transition-transform">
                                        <i class="fas fa-eraser text-yellow-600 text-sm"></i>
                                    </div>
                                    <div>
                                        <p class="font-semibold text-sm text-slate-800">AI Watermark Removal</p>
                                    </div>
                                </a>
                                <a href="/pricing.html" class="flex items-center p-3 bg-white rounded-lg shadow-sm hover:shadow-md hover:border-red-500 border border-transparent transition group">
                                    <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3 group-hover:scale-110 transition-transform">
                                        <i class="fas fa-closed-captioning text-blue-600 text-sm"></i>
                                    </div>
                                    <div>
                                        <p class="font-semibold text-sm text-slate-800">Transcript Generator</p>
                                    </div>
                                </a>
                                <a href="/pricing.html" class="block text-center mt-4 bg-slate-800 text-white font-bold text-sm py-3 rounded-lg hover:bg-slate-900 transition-all duration-300 transform hover:-translate-y-0.5 shadow-lg shadow-slate-300">
                                    Unlock All Tools
                                </a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>`;

            resultSection.classList.remove('hidden');
        }
        // BATCH STEP 2: Render the video preview and confirmation screen
        function renderBatchPreview(resultsArray) {
            const listHtml = resultsArray.map((itemArray, index) => {
                if (Array.isArray(itemArray) && itemArray.length > 0 && itemArray[0]) {
                    const video = itemArray[0];
                    return `
                    <div class="flex items-center p-3 rounded-lg hover:bg-slate-50 border border-slate-200">
                        <input type="checkbox" id="video-checkbox-${index}" data-url="${video.url}" class="h-5 w-5 mr-4 rounded text-red-600 focus:ring-red-500 cursor-pointer" checked>
                        <img src="${video.thumbnail}" class="w-24 h-14 object-cover rounded-md shadow mr-4" alt="thumbnail">
                        <div class="flex-grow overflow-hidden">
                            <p class="font-semibold text-slate-800 leading-tight truncate" title="${video.title}">${video.title}</p>
                            <p class="text-sm text-slate-500">${video.uploader} • ${video.duration}s</p>
                        </div>
                    </div>`;
                } else {
                    return `
                    <div class="flex items-center bg-red-50 p-3 rounded-lg border border-red-200 opacity-80">
                        <input type="checkbox" class="h-5 w-5 mr-4" disabled>
                        <div class="w-24 h-14 bg-red-100 rounded-md mr-4 flex items-center justify-center"><i class="fas fa-exclamation-triangle text-red-400"></i></div>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-semibold text-red-700">Analysis Failed</p>
                            <p class="text-sm text-red-500 truncate">Invalid Link or Private Video</p>
                        </div>
                    </div>`;
                }
            }).join('');

            resultSection.innerHTML = `
            <div class="bg-white rounded-2xl shadow-2xl p-8 text-left">
                <h3 class="text-xl font-bold mb-4 text-slate-800">Confirm Videos for Download</h3>
                <p class="text-slate-600 mb-6">Uncheck any videos you don't want to download, then choose a format and start the process.</p>
                <div id="videoPreviewList" class="space-y-3 mb-6 max-h-[50vh] overflow-y-auto pr-2 custom-scrollbar">${listHtml}</div>
                <div class="flex flex-col sm:flex-row gap-4 items-center bg-slate-50 p-4 rounded-lg border">
                    <select id="formatChoice" class="w-full sm:flex-grow p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500">
                        <option value="1080p" selected>1080p HD (MP4)</option>
                        <option value="720p">720p SD (MP4)</option>
                        <option value="audio">Best Audio Only (MP3)</option>
                    </select>
                    <button id="batchStartBtn" class="w-full sm:w-auto bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg disabled:opacity-50 transition-colors">Start Download</button>
                </div>
            </div>`;
            resultSection.classList.remove('hidden');
        }

        // BATCH STEP 3: Render the progress screen
        function renderBatchProgressUI(total) {
            resultSection.innerHTML = `
            <div class="bg-white rounded-2xl shadow-2xl p-8 text-left">
                <div id="progressContainer" class="mb-4 space-y-2">
                    <div class="flex justify-between font-medium text-slate-700"><span id="progressText">Initializing...</span> <span>Target: ${total} Videos</span></div>
                    <div class="w-full bg-slate-200 rounded-full h-4"><div id="progressBar" class="bg-red-500 h-4 rounded-full transition-all duration-500" style="width: 0%"></div></div>
                </div>
                <h3 class="text-lg font-semibold text-slate-800 mt-6 mb-2">Live Status</h3>
                <div id="logArea" class="h-32 bg-slate-900 text-slate-300 font-mono text-sm p-4 rounded-lg overflow-y-auto custom-scrollbar flex items-center justify-center">
                    <span class="animate-pulse">Waiting for server...</span>
                </div>
                
                <div id="completionArea" class="hidden mt-8 text-center p-6 bg-green-50 rounded-xl border border-green-200">
                     <i class="fas fa-check-circle text-5xl text-green-500 mb-4"></i>
                     <h3 class="text-xl font-bold text-green-800 mb-2">Batch Processing Complete!</h3>
                     <p class="text-green-700 mb-6">Your videos have been zipped and are ready for download.</p>
                     <a id="zipDownloadBtn" href="#" class="inline-flex items-center justify-center bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-transform transform hover:-translate-y-1">
                        <i class="fas fa-file-archive mr-2"></i> Download All (ZIP)
                     </a>
                </div>

                <div class="text-center mt-6">
                    <button id="batchResetBtn" class="text-slate-500 hover:text-slate-700 underline text-sm">Start New Batch</button>
                </div>
            </div>`;
            resultSection.classList.remove('hidden');
        }

        // --- BATCH WORKFLOW LOGIC ---
        // BATCH STEP 1: Analyze Links
        async function handleBatchAnalyze() {
            const links = extractAndValidateLinks(batchInput.value);
            if (links.length === 0) { showError('No valid YouTube links found.'); return; }
            if (links.length > 5) { showError('You can only analyze up to 5 links at a time.'); return; }
            setLoading(true, 'batch', `Analyzing ${links.length} links...`);
            inputSection.classList.add('hidden');
            resultSection.innerHTML = renderSkeleton();
            resultSection.classList.remove('hidden');

            try {
                // API 2.1: Batch Get Info
                const response = await fetch(`${API_BASE_URL}/api/batch-info`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ urls: links })
                });
                const resJson = await response.json();

                if (resJson.code !== 0) throw new Error("Batch analysis failed.");

                renderBatchPreview(resJson.data);
            } catch (error) {
                showError(`Analysis failed: ${error.message}`);
                resultSection.classList.add('hidden');
                inputSection.classList.remove('hidden');
            } finally {
                setLoading(false, 'batch');
            }
        }

        // BATCH STEP 2: Start Download Task
        async function handleBatchStartDownload() {
            const selectedInputs = Array.from(document.querySelectorAll('#videoPreviewList input:checked'));
            if (selectedInputs.length === 0) {
                showToast('Please select at least one video to download.', 'error');
                return;
            }
            const formatChoice = document.getElementById('formatChoice').value;

            // Construct request body for API 2.2
            const videosPayload = selectedInputs.map(input => ({
                url: input.dataset.url,
                quality: formatChoice
            }));

            renderBatchProgressUI(videosPayload.length);
            const startBtn = document.getElementById('batchStartBtn');
            if (startBtn) startBtn.disabled = true;

            try {
                // API 2.2: Submit Batch Download Task
                const response = await fetch(`${API_BASE_URL}/api/batch-download`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ videos: videosPayload })
                });

                const resJson = await response.json();
                if (resJson.code !== 0) throw new Error('Failed to submit task.');

                const taskId = resJson.task_id;
                batchPollingInterval = setInterval(() => pollTaskStatus(taskId), 2000);
                pollTaskStatus(taskId); // Immediate check
            } catch (error) {
                document.getElementById('logArea').innerHTML = `<div class="text-red-400">[ERROR] ${error.message}</div>`;
            }
        }

        // BATCH STEP 3: Poll and Update UI
        async function pollTaskStatus(taskId) {
            try {
                // API 2.3: Task Status Polling
                const response = await fetch(`${API_BASE_URL}/api/task-status?task_id=${taskId}`);
                const resJson = await response.json();

                if (resJson.code !== 0) throw new Error("Polling error");

                const task = resJson.data; // { status, current, total }

                // Update Progress Bar
                const percentage = task.total > 0 ? (task.current / task.total) * 100 : 0;
                document.getElementById('progressBar').style.width = `${percentage}%`;
                document.getElementById('progressText').textContent = `${task.current} / ${task.total}`;

                // Update Status Text
                const logArea = document.getElementById('logArea');
                logArea.innerHTML = `<div class="text-center font-bold text-lg">${task.status}</div>`;

                // Check Completion
                if (task.status === 'completed' || (task.current === task.total && task.total > 0)) {
                    clearInterval(batchPollingInterval);
                    document.getElementById('progressBar').classList.add('bg-green-500');
                    document.getElementById('logArea').classList.add('hidden');

                    // Show ZIP Download UI
                    const completionArea = document.getElementById('completionArea');
                    const zipBtn = document.getElementById('zipDownloadBtn');

                    completionArea.classList.remove('hidden');

                    // API 2.4: Download ZIP Link
                    zipBtn.href = `${API_BASE_URL}/api/download-zip?task_id=${taskId}`;
                }

            } catch (error) {
                clearInterval(batchPollingInterval);
                document.getElementById('logArea').innerHTML = `<div class="text-red-400 font-bold">Connection Lost. Please try again.</div>`;
            }
        }

        // --- SINGLE DOWNLOAD WORKFLOW ---
        async function handleSingleGetInfo(url) {
            setLoading(true, 'single');
            resultSection.innerHTML = renderSkeleton();
            resultSection.classList.remove('hidden');
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'center' });

            try {
                // API 1.1: Get Video Info (GET)
                const response = await fetch(`${API_BASE_URL}/api/info?url=${encodeURIComponent(url)}`);
                const resJson = await response.json();

                if (resJson.code !== 0) throw new Error(resJson.error || resJson.message || "Could not fetch video info");

                renderSingleResults(resJson.data);
            } catch (error) {
                showError(`Failed to get video info: ${error.message}`);
                resultSection.innerHTML = `<div class="text-red-600 p-4 bg-red-50 rounded-lg text-center font-bold">Error: ${error.message}</div>`;
            } finally {
                setLoading(false, 'single');
            }
        }

        // --- NEW: Handle AI Summary Generation ---
        async function handleGenerateSummary(url) {
            const langSelect = document.getElementById('summary-lang-select');
            const lang = langSelect.value;
            const container = document.getElementById('summary-container');
            const output = document.getElementById('summary-text-output');
            const btn = document.getElementById('btn-generate-summary');
            const cursor = document.getElementById('summary-cursor');

            // UI Reset
            container.classList.remove('hidden');
            output.innerHTML = '';
            cursor.classList.remove('hidden');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';

            let fullMarkdown = '';

            try {
                const response = await fetch(`${API_BASE_URL}/api/summarize?url=${encodeURIComponent(url)}&lang=${lang}`);

                if (!response.ok) {
                    // Handle HTTP errors (e.g., 501 or 500)
                    let errorMessage = `Server error: ${response.status}`;
                    try {
                        const errData = await response.json();
                        if (errData.message) errorMessage = errData.message;
                    } catch (e) {
                        // If response is not JSON (e.g. standard Flask 500 HTML), treat as text
                        const text = await response.text();
                        if (text) errorMessage = `Server error: ${text.substring(0, 100)}...`;
                    }
                    throw new Error(errorMessage);
                }

                const reader = response.body.getReader();
                console.log(reader);
                console.log(response.body);
                const decoder = new TextDecoder();

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value, { stream: true });

                    // Check for backend error sent as text stream
                    if (fullMarkdown === '' && chunk.startsWith('[ERROR]')) {
                        throw new Error(chunk.replace('[ERROR]', '').trim());
                    }

                    fullMarkdown += chunk;

                    // Render Markdown
                    if (typeof marked !== 'undefined') {
                        output.innerHTML = marked.parse(fullMarkdown);
                    } else {
                        // Fallback if marked is failed to load
                        output.textContent = fullMarkdown;
                    }

                    // Auto-scroll
                    output.parentElement.scrollTop = output.parentElement.scrollHeight;
                }

            } catch (e) {
                output.innerHTML = `<span class="text-red-500 font-bold"><i class="fas fa-exclamation-triangle"></i> Error: ${e.message}</span>`;
                btn.innerHTML = '<i class="fas fa-magic"></i> Retry Summary';
            } finally {
                cursor.classList.add('hidden');
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-magic"></i> Generate Summary';
            }
        }


        // --- EVENT LISTENERS ---
        downloadButton.addEventListener('click', (e) => {
            e.preventDefault(); clearError();
            const mode = downloadButton.dataset.currentMode;
            if (mode === 'single') {
                const url = singleInput.value.trim();
                if (!url || !isValidYouTubeUrl(url)) { showError('Please enter a valid YouTube link.'); return; }
                handleSingleGetInfo(url);
            } else {
                handleBatchAnalyze();
            }
        });

        resultSection.addEventListener('click', async (e) => {
            // ==========================================================
            // FIX: Single Video Download Logic - Uses fetch + Blob
            // ==========================================================
            const downloadBtn = e.target.closest('.download-link-btn');
            const summaryBtn = e.target.closest('#btn-generate-summary');

            // Handle Summary Button Click
            if (summaryBtn) {
                e.preventDefault();
                const url = summaryBtn.getAttribute('data-url');
                if (url) handleGenerateSummary(url);
                return;
            }

            if (downloadBtn) {
                e.preventDefault();

                // 1. Get parameters securely from DOM
                const targetUrl = downloadBtn.getAttribute('data-url');
                const targetQuality = downloadBtn.getAttribute('data-format-id');

                if (!targetUrl || !targetQuality) {
                    showToast('Error: Missing download parameters. Please refresh.', 'error');
                    return;
                }
                // 2. Visual Feedback
                const originalText = downloadBtn.innerHTML;
                const originalIcon = downloadBtn.querySelector('i');
                const originalIconClass = originalIcon ? originalIcon.className : '';

                // Update text to indicate we are waiting for the server/download
                // If it's a small icon button inside the list, we just spin the icon
                if (downloadBtn.classList.contains('text-slate-700')) {
                    if (originalIcon) originalIcon.className = 'fas fa-spinner fa-spin mr-1';
                } else {
                    downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Downloading...';
                }

                downloadBtn.disabled = true;

                try {
                    // 3. Construct GET URL
                    let downloadApiUrl = '';

                    // CHECK IF SUBTITLE (starts with sub_)
                    if (targetQuality.startsWith('sub_')) {
                        // format is sub_srt_lang or sub_txt_lang
                        const parts = targetQuality.split('_');
                        const fmt = parts[1]; // srt or txt
                        const lang = parts.slice(2).join('_'); // lang code
                        downloadApiUrl = `${API_BASE_URL}/api/subtitle?url=${encodeURIComponent(targetUrl)}&lang=${lang}&format=${fmt}`;
                    } else {
                        // Standard Video/Audio
                        downloadApiUrl = `${API_BASE_URL}/api/download?url=${encodeURIComponent(targetUrl)}&quality=${encodeURIComponent(targetQuality)}`;
                    }

                    // 4. Perform the Request (Wait for the server to return the file)
                    const response = await fetch(downloadApiUrl);

                    if (!response.ok) {
                        throw new Error(`Server error: ${response.status}`);
                    }

                    // 5. Convert response to Blob (File object in memory)
                    const blob = await response.blob();

                    // 6. Create a temporary link to trigger the "Save As" dialog
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;

                    // Attempt to extract filename from headers, fallback to default
                    const disposition = response.headers.get('Content-Disposition');
                    let fileName = downloadBtn.getAttribute('data-title').replace(/[^\w\s-]/g, '') + '.mp4';

                    // Adjust extension for subtitles if needed fallback
                    if (targetQuality.startsWith('sub_txt')) fileName = fileName.replace('.mp4', '.txt');
                    else if (targetQuality.startsWith('sub_srt')) fileName = fileName.replace('.mp4', '.srt');

                    if (disposition && disposition.includes('filename=')) {
                        const filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                        const matches = filenameRegex.exec(disposition);
                        if (matches != null && matches[1]) {
                            fileName = matches[1].replace(/['"]/g, '');
                        }
                    }
                    a.download = fileName;

                    document.body.appendChild(a);
                    a.click(); // Trigger download

                    // Cleanup memory
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);

                } catch (error) {
                    console.error('Download failed:', error);
                    showToast('Download failed. Please check your connection and try again.', 'error');
                } finally {
                    // 7. Reset button state ONLY after request is finished (Success or Fail)
                    if (downloadBtn.classList.contains('text-slate-700')) {
                        if (originalIcon) originalIcon.className = originalIconClass;
                    } else {
                        downloadBtn.innerHTML = originalText;
                    }
                    downloadBtn.disabled = false;
                }
            }

            // Tabs Logic
            const tabBtn = e.target.closest('.tab-button');
            if (tabBtn) {
                // 1. 获取所有 Tab 按钮
                const allTabs = document.querySelectorAll('.tab-button');

                // 2. 重置所有按钮为 "未选中" 状态 (灰色文字，透明边框)
                allTabs.forEach(btn => {
                    const isSummary = btn.dataset.tab === 'summary';
                    btn.classList.remove('border-red-500', 'text-red-600', 'border-red-500', 'text-slate-600'); // 移除选中样式
                    btn.classList.add('border-transparent', 'text-slate-600'); // 添加未选中样式
                });

                // 3. 设置当前点击的按钮为 "选中" 状态
                tabBtn.classList.remove('border-transparent', 'text-slate-600'); // 移除未选中样式

                if (tabBtn.dataset.tab === 'summary') {
                    tabBtn.classList.add('border-red-500', 'text-red-600');
                } else {
                    tabBtn.classList.add('border-red-500', 'text-red-600');
                }

                // 4. 切换下方显示的内容区域
                document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
                const targetContent = resultSection.querySelector(`[data-content="${tabBtn.dataset.tab}"]`);
                if (targetContent) {
                    targetContent.classList.remove('hidden');
                }
            }


            if (e.target.id === 'batchStartBtn') handleBatchStartDownload();
            if (e.target.id === 'batchResetBtn') switchMode('batch');
        });
        const setupInput = (input, clearBtn) => {
            input.addEventListener('input', () => clearBtn.classList.toggle('hidden', !input.value));
            clearBtn.addEventListener('click', () => { input.value = ''; clearBtn.classList.add('hidden'); input.focus(); });
        };
        setupInput(singleInput, clearSingleBtn);
        setupInput(batchInput, clearBatchBtn);

        modeSwitchBtns.forEach(btn => btn.addEventListener('click', () => switchMode(btn.dataset.mode)));
        window.addEventListener('DOMContentLoaded', () => switchMode('single'));

        // --- Mobile Drawer & Third Party Scripts ---
        function openDrawer() { mobileDrawer.classList.remove("translate-x-full"), mobileBackdrop.classList.remove("backdrop-hidden"), mobileBackdrop.classList.add("backdrop-show"), document.body.classList.add("overflow-hidden") } function closeDrawer() { mobileDrawer.classList.add("translate-x-full"), mobileBackdrop.classList.add("backdrop-hidden"), mobileBackdrop.classList.remove("backdrop-show"), document.body.classList.remove("overflow-hidden") } mobileMenuBtn.addEventListener("click", openDrawer), mobileMenuClose.addEventListener("click", closeDrawer), mobileBackdrop.addEventListener("click", closeDrawer); let thirdPartyScriptsLoaded = !1; function loadThirdPartyScripts() { if (thirdPartyScriptsLoaded) return; thirdPartyScriptsLoaded = !0; const e = document.createElement("script"); e.src = "https://www.googletagmanager.com/gtag/js?id=G-Z6TQTL70L0", e.async = !0, e.onload = function () { window.dataLayer = window.dataLayer || [], window.gtag = function () { dataLayer.push(arguments) }, gtag("js", new Date), gtag("config", "G-Z6TQTL70L0") }, document.head.appendChild(e) } ["mousemove", "scroll", "keydown", "touchstart", "click"].forEach(function (e) { window.addEventListener(e, loadThirdPartyScripts, { once: !0, passive: !0 }) }), setTimeout(loadThirdPartyScripts, 5e3);
    </script>
</body>

</html>